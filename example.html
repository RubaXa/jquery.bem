<!DOCTYPE html>
<html>
<head>
	<title>Example :: jQuery BEM</title>

	<link href="static/style.css" rel="stylesheet"/>

	<script src="http://code.jquery.com/jquery-1.7.2.js"></script>

	<script src="./jquery.bem.js"></script>
	<script src="./bem/jquery.bem.control.js"></script>
	<script src="./bem/jquery.bem.list.js"></script>
	<script src="./bem/jquery.bem.filter.js"></script>
	<script src="./bem/jquery.bem.dropdown.js"></script>

</head>
<body>
	<div style="margin: 20px 40px;">
		<h1>jQuery BEM</h1>
	</div>

	<div style="margin: 40px;">
		<a href="#btn1" class="js-tab b-button">Active</a>
		<a href="#btn2" class="js-tab b-button">Active</a>
		<a href="#btn3" class="js-tab b-button b-button_disabled">Disabled</a>
	</div>
	
	
	<div style="margin: 40px;">
		<label for="cbx"><span class="js-tab cbx"><span class="cbx__checkmark"><input id="cbx" type="checkbox"/></span></span> label</label>
		<span class="js-tab cbx"><span class="cbx__checkmark"><input type="checkbox"/></span></span>
		<span class="js-tab cbx"><span class="cbx__checkmark"><input type="checkbox"/></span></span>
	</div>


	<div style="margin: 40px;">
		<div class="js-tab b-dropdown" tabindex="4">
			<span class="b-dropdown__link">Dropdown</span>
			<div class="b-dropdown__list">
				<div class="b-dropdown__list__item">item</div>
				<div class="b-dropdown__list__item">item</div>
				<div class="b-dropdown__list__item">item</div>
				<div class="b-dropdown__list__item b-dropdown__list__item_disabled">item</div>
				<div class="b-dropdown__list__item b-dropdown__list__item_disabled">item</div>
				<div class="b-dropdown__list__item">item</div>
				<div class="b-dropdown__list__item b-dropdown__list__item_disabled">item</div>
				<div class="b-dropdown__list__item">item</div>
			</div>
		</div>

		<div class="js-tab js-MoveTo b-dropdown" tabindex="5">
			<span class="b-dropdown__link">Move to</span>
			<div class="b-dropdown__list">
				<div class="b-filter">
					<div class="b-dropdown__list__filter"><input type="text" class="b-filter__input"/></div>
					<div class="b-filter__list">
						<div class="js-filter-item b-dropdown__list__item">Inbox</div>
						<div class="js-filter-item b-dropdown__list__item">RubaXa.org</div>
						<div class="js-filter-item b-dropdown__list__item">RubaXa.org/ibn</div>
						<div class="js-filter-item b-dropdown__list__item">RubaXa.org/trash</div>
						<div class="js-filter-item b-dropdown__list__item">mail.ru</div>
						<div class="js-filter-item b-dropdown__list__item">Drafts</div>
						<div class="js-filter-item b-dropdown__list__item">Sent</div>
						<div class="js-filter-item b-dropdown__list__item">github.com</div>
						<div class="js-filter-item b-dropdown__list__item">Spam</div>
						<div class="js-filter-item b-dropdown__list__item">Trash</div>
					</div>
				</div>
			</div>
		</div>
	</div>


	<div style="margin: 40px;">
		<div class="b-todos">
			<h2 class="b-todos__h1">Todos :]</h2>
			<form>
				<input placeholder="What needs to be done?" name="item" value="" class="js-tab js-new-item b-todos__inp" />
			</form>
			<div class="js-list b-todos__list js-tab" onclick="return { autoSelect: true }">
				<label for="cbx_x1" class="js-item b-todos__list__item"><span class="js-tab cbx"><span class="cbx__checkmark"><input id="cbx_x1" class="js-cbx" type="checkbox"></span></span>navigate</label>
				<label for="cbx_x2" class="js-item b-todos__list__item"><span class="js-tab cbx"><span class="cbx__checkmark"><input id="cbx_x2" class="js-cbx" type="checkbox"></span></span>up/down</label>
			</div>
			<div class="b-todos__info"></div>
		</div>
	</div>


	<script>
		$.bem(['b-checkbox', 'cbx']);

		$('.js-MoveTo').on('expand', function (){
			$('.b-dropdown :input:first').focus();
		});


		function iTab(){
			$('.js-tab').each(function (i){
				this.tabIndex = i + 1;
			});
		}
		iTab();

		// App
		(function ($){
			var $ui = $('.b-todos'), items = [];

			$ui
				.on('submit', 'form', function (evt){
					evt.preventDefault();
					var $text = $(':text', evt.target), id = 'cbx_'+ ++$.guid;

					$('<label for="'+id+'" class="js-item b-todos__list__item"></label>')
						.append('<span class="cbx"><span class="cbx__checkmark"><input id="'+id+'" class="js-cbx" type="checkbox"/></span></span>')
						.append($text.val())
						.appendTo($ui.find('.js-list'))
					;

					$text.val('');
					iTab();
				})
				.on('change', '.js-cbx', function (evt){
					var cbx = evt.currentTarget;
					$(cbx)
						.closest('.js-item')
						.toggleClass('b-todos__list__item_checked', !!cbx.checked)
					;
				})
				.on('hoveritem', '.js-list', function (evt){
					var prev = evt.relatedTarget, node = evt.target;

					if( prev ) $('.cbx', prev).focusout();
					if( node ) $('.cbx', node).focus();
				})
			;

			$.bem(['b-list', 'b-todos__list']);
		})(jQuery)
	</script>

</body>
</html>
